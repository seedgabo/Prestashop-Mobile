
<ion-navbar primary *navbar>
    <ion-title>
        Categorias | <span> {{ps.user? ps.user.firstname : 'Invitado'}}</span>
    </ion-title>
    <ion-buttons end>
         <button (click)="navToCarrito()">
             <ion-icon name="cart"></ion-icon>
         </button>

         <button (click)="navToUser()">
             <ion-icon name="person"></ion-icon>
         </button>
    </ion-buttons>
</ion-navbar>

<ion-content  class="page2">

    <ion-card  no-padding>
        <div>
            <button light small round (click)="toggleMenu= !toggleMenu"><ion-icon name="menu" ></ion-icon></button>
            <button light small  *ngFor="#item of order, #i = index"  (click)="order = order.slice(0,i); cat = filtrarCategorias(item);">
                {{ getCagoriabyId(item).name }}
            </button>
        </div>
        <ion-list *ngIf="toggleMenu">

            <button class="category-item" ion-item *ngFor="#item of cat" (click)="cat = filtrarCategorias(item.id)">
                <ion-avatar item-left>
                    <img [src]="ps.url + 'images/categories/'+ item.id + ps.append" alt=" " title="Imagen categoria" />
                </ion-avatar>
                {{item.name}}
            </button>
        </ion-list>
    </ion-card>

    <ion-list [virtualScroll]="productos" approxItemHeight="100px" bufferRatio="4">
        <button ion-item  *virtualItem="#producto" (click)="verProducto(producto)">
            <ion-thumbnail item-left>
                <ion-img *ngIf="producto.id_default_image" [src]="ps.url + 'images/products/' + producto.id + '/' + producto.id_default_image+ '/small_default'+ ps.append"></ion-img>
                <img *ngIf="!producto.id_default_image" src="img/sin-imagen.jpg"/>
            </ion-thumbnail>
            <h2>{{producto.name}}</h2>
            <h3 secondary>{{producto.quantity > 0 ? producto.quantity :  "Disponible"}}</h3>
            <p>{{ toCurrency(producto.precio) |currency:'USD':true:'1.2-2'}}</p>
            <button clear item-right>Ver</button>
        </button>
    </ion-list>

    <ion-infinite-scroll (infinite)="loadMoreProducts($event)" *ngIf="more">
        <ion-infinite-scroll-content
        loadingText="Cargando Mas Productos...">
        ></ion-infinite-scroll-content>
    </ion-infinite-scroll>

</ion-content>

<button fab fab-top fab-right clear style="z-index:10" (click)="toTop()"><ion-icon name="arrow-dropup"></ion-icon></button>
